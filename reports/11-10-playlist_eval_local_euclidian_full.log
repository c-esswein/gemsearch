nohup: ignoring input
2017-11-10 17:23:47,432 - summa.preprocessing.cleaner - INFO - 'pattern' package not found; tag filters are not available for English
2017-11-10 17:23:47,464 - __main__ - INFO - started playlist eval with config: {'dataDir': 'data/full_model/', 'outDir': 'data/rec_all/', 'SHOULD_GENERATE_GRAPH': True, 'SHOULD_INDEX_ES': True, 'TEST_PLAYLIST_SPLIT': 0.2, 'PRECISION_AT': [1, 5, 10, 15], 'USE_USER_IN_QUERY': True, 'SHOULD_EMBED': True, 'ARGS': Namespace(album=True, genre=True, tags=True)}
2017-11-10 17:23:47,464 - __main__ - INFO - %%% playlist_eval runner... 
2017-11-10 17:23:49,655 - gemsearch.evaluation.playlist_query_evaluator - INFO - Splitted playlists for training (17068) and test (4234), total (21336)
2017-11-10 17:23:49,655 - gemsearch.evaluation.playlist_query_evaluator - INFO - dropped because of invalid split (user in test but not in training) 34
------------- generate graph -------------
2017-11-10 17:23:49,894 - __main__ - INFO - %%% graph generation... 
2017-11-10 17:26:10,892 - gemsearch.core.type_counter - INFO - Collected items by type:
2017-11-10 17:26:10,893 - gemsearch.core.type_counter - INFO - track: 852293
2017-11-10 17:26:10,893 - gemsearch.core.type_counter - INFO - artist: 106581
2017-11-10 17:26:10,893 - gemsearch.core.type_counter - INFO - tag: 395587
2017-11-10 17:26:10,893 - gemsearch.core.type_counter - INFO - album: 189174
2017-11-10 17:26:10,893 - gemsearch.core.type_counter - INFO - genre: 1520
2017-11-10 17:26:10,893 - gemsearch.core.type_counter - INFO - user: 1148
2017-11-10 17:26:10,894 - gemsearch.core.type_counter - INFO - -- Total: 1546303 --
2017-11-10 17:26:10,894 - __main__ - INFO - %%% graph generation done in 141.0s


2017-11-10 17:26:10,894 - __main__ - INFO - %%% elastic search writer... 
all indexes cleared
{'_shards': {'failed': 0, 'successful': 5, 'total': 5}, 'count': 1545155}
2017-11-10 17:28:37,898 - __main__ - INFO - %%% elastic search writer done in 147.004s


2017-11-10 17:28:37,899 - __main__ - INFO - %%% embedding 20_20_10_64_deepwalk... 
2017-11-10 17:28:37,899 - deepwalk.runner - INFO - started deepwalk with config: Namespace(debug=False, format='edgelist', input='data/rec_all/graph.txt', log='INFO', max_memory_data_size=7000000, method='deepwalk', number_walks=20, output='data/rec_all/deepwalk.em', representation_size=64, seed=42, undirected=True, vertex_freq_degree=False, walk_length=20, weighted=True, window_size=10, workers=3)
2017-11-10 17:29:30,363 - deepwalk - INFO - make_consistent: made consistent in 17.818397283554077s
2017-11-10 17:29:34,264 - deepwalk - INFO - remove_self_loops: removed 0 loops in 3.899752616882324s
2017-11-10 17:29:34,264 - deepwalk.runner - INFO - Number of nodes: 1546303
2017-11-10 17:29:34,264 - deepwalk.runner - INFO - Number of walks: 30926060
2017-11-10 17:29:34,264 - deepwalk.runner - INFO - Data size (walks*length): 618521200
2017-11-10 17:29:34,265 - deepwalk.runner - INFO - Data size 618521200 is larger than limit (max-memory-data-size: 7000000).  Dumping walks to disk.
2017-11-10 17:29:34,265 - deepwalk.runner - INFO - Start Walking...
2017-11-10 18:07:59,038 - deepwalk.runner - INFO - Start Training...
2017-11-10 20:45:56,801 - deepwalk.runner - INFO - Delete serialized walks
2017-11-10 20:45:57,320 - gensim.models.keyedvectors - INFO - storing 1546303x64 projection weights into data/rec_all/deepwalk.em
2017-11-10 20:46:56,683 - __main__ - INFO - %%% embedding 20_20_10_64_deepwalk done in 11898.784s


2017-11-10 20:46:56,684 - __main__ - INFO - %%% ge calc initializing... 
2017-11-10 20:47:48,566 - __main__ - INFO - %%% ge calc initializing done in 51.882s


2017-11-10 20:47:48,567 - __main__ - INFO - ------------- evaluation -------------
2017-11-10 20:47:48,567 - __main__ - INFO - %%% evaluation... 
2017-11-10 20:47:48,567 - gemsearch.evaluation.playlist_query_evaluator - INFO - Extract queries from playlist names (result is cached)
2017-11-10 20:55:24,913 - gemsearch.evaluation.playlist_query_evaluator - INFO - For evaluation 4159 of 4234 playlists are left
2017-11-10 20:55:24,918 - gemsearch.evaluation.playlist_query_evaluator - INFO - Started playlist evaluation with 4159 playlists
2017-11-11 02:21:55,583 - gemsearch.evaluation.playlist_query_evaluator - INFO - Playlist evaluation finished: total 4159 playlists (testsplit=0.2)
[{'key': 'rec_random_tracks@1',
  'values': {'avg_hits': 0.0,
             'avg_hits_on_has_hits': 0,
             'has_hits': 0,
             'precision': 0.0,
             'precision_on_has_hits': 0,
             'recall': 0.0}},
 {'key': 'rec_random_tracks@5',
  'values': {'avg_hits': 0.00024044241404183698,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 1,
             'precision': 4.80884828083674e-05,
             'precision_on_has_hits': 0.2,
             'recall': 1.807837699562684e-06}},
 {'key': 'rec_random_tracks@10',
  'values': {'avg_hits': 0.00048088482808367395,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 2,
             'precision': 4.80884828083674e-05,
             'precision_on_has_hits': 0.1,
             'recall': 2.1844705536382433e-05}},
 {'key': 'rec_random_tracks@15',
  'values': {'avg_hits': 0.0009617696561673479,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 4,
             'precision': 6.411797707782319e-05,
             'precision_on_has_hits': 0.06666666666666667,
             'recall': 3.071407176522558e-05}},
 {'key': 'rec_tracks_with_user@1',
  'values': {'avg_hits': 0.007694157249338783,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 32,
             'precision': 0.007694157249338783,
             'precision_on_has_hits': 1.0,
             'recall': 0.00013899535981789856}},
 {'key': 'rec_tracks_with_user@5',
  'values': {'avg_hits': 0.03871122866073575,
             'avg_hits_on_has_hits': 1.4375,
             'has_hits': 112,
             'precision': 0.007742245732147143,
             'precision_on_has_hits': 0.2874999999999997,
             'recall': 0.0007583861141895924}},
 {'key': 'rec_tracks_with_user@15',
  'values': {'avg_hits': 0.12142341909112768,
             'avg_hits_on_has_hits': 1.9803921568627452,
             'has_hits': 255,
             'precision': 0.008094894606075166,
             'precision_on_has_hits': 0.13202614379084948,
             'recall': 0.0023035644500971706}},
 {'key': 'rec_tracks_with_user@10',
  'values': {'avg_hits': 0.08175042077422458,
             'avg_hits_on_has_hits': 1.7435897435897436,
             'has_hits': 195,
             'precision': 0.008175042077422475,
             'precision_on_has_hits': 0.1743589743589747,
             'recall': 0.001566839202870182}},
 {'key': 'rec_query_tracks_with_user_mean@1',
  'values': {'avg_hits': 0.01659052656888675,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 69,
             'precision': 0.01659052656888675,
             'precision_on_has_hits': 1.0,
             'recall': 0.0005881634757022559}},
 {'key': 'rec_query_tracks_with_user@15',
  'values': {'avg_hits': 0.2656888675162299,
             'avg_hits_on_has_hits': 1.9981916817359855,
             'has_hits': 553,
             'precision': 0.017712591167748738,
             'precision_on_has_hits': 0.13321277878239965,
             'recall': 0.009537122935152922}},
 {'key': 'rec_query_tracks_with_user_mean@15',
  'values': {'avg_hits': 0.2656888675162299,
             'avg_hits_on_has_hits': 2.080979284369115,
             'has_hits': 531,
             'precision': 0.017712591167748773,
             'precision_on_has_hits': 0.13873195229127522,
             'recall': 0.008660346509648897}},
 {'key': 'rec_query_tracks_with_user_mean@10',
  'values': {'avg_hits': 0.18033181053137773,
             'avg_hits_on_has_hits': 1.8159806295399517,
             'has_hits': 413,
             'precision': 0.018033181053137805,
             'precision_on_has_hits': 0.18159806295399547,
             'recall': 0.005866558381536231}},
 {'key': 'rec_query_tracks_with_user_mean@5',
  'values': {'avg_hits': 0.09329165664823275,
             'avg_hits_on_has_hits': 1.4586466165413534,
             'has_hits': 266,
             'precision': 0.01865833132964661,
             'precision_on_has_hits': 0.2917293233082716,
             'recall': 0.0030966430459521306}},
 {'key': 'rec_query_tracks_with_user@10',
  'values': {'avg_hits': 0.18682375571050733,
             'avg_hits_on_has_hits': 1.7619047619047619,
             'has_hits': 441,
             'precision': 0.018682375571050736,
             'precision_on_has_hits': 0.1761904761904762,
             'recall': 0.006666729471475915}},
 {'key': 'rec_query_tracks_with_user@5',
  'values': {'avg_hits': 0.10218802596778072,
             'avg_hits_on_has_hits': 1.4554794520547945,
             'has_hits': 292,
             'precision': 0.020437605193556224,
             'precision_on_has_hits': 0.29109589041096007,
             'recall': 0.003713024964770541}},
 {'key': 'rec_query_tracks_with_user@1',
  'values': {'avg_hits': 0.021639817263765328,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 90,
             'precision': 0.021639817263765328,
             'precision_on_has_hits': 1.0,
             'recall': 0.0007829607507943821}},
 {'key': 'rec_first_two_query_tracks_with_user@15',
  'values': {'avg_hits': 0.43183457561913924,
             'avg_hits_on_has_hits': 2.245,
             'has_hits': 800,
             'precision': 0.02878897170794267,
             'precision_on_has_hits': 0.14966666666666695,
             'recall': 0.017966964443701057}},
 {'key': 'rec_first_two_query_tracks_with_user@10',
  'values': {'avg_hits': 0.31161336859822075,
             'avg_hits_on_has_hits': 1.9171597633136095,
             'has_hits': 676,
             'precision': 0.031161336859821913,
             'precision_on_has_hits': 0.19171597633135998,
             'recall': 0.013205200898304386}},
 {'key': 'rec_query_tracks_with_user_scaled@15',
  'values': {'avg_hits': 0.5099783601827362,
             'avg_hits_on_has_hits': 2.4577056778679025,
             'has_hits': 863,
             'precision': 0.03399855734551573,
             'precision_on_has_hits': 0.16384704519119342,
             'recall': 0.022892023654817878}},
 {'key': 'rec_first_two_query_tracks_with_user@5',
  'values': {'avg_hits': 0.17335898052416446,
             'avg_hits_on_has_hits': 1.5307855626326965,
             'has_hits': 471,
             'precision': 0.034671796104832946,
             'precision_on_has_hits': 0.3061571125265397,
             'recall': 0.007534228564351008}},
 {'key': 'rec_query_tracks_with_user_scaled@10',
  'values': {'avg_hits': 0.3568165424380861,
             'avg_hits_on_has_hits': 2.0842696629213484,
             'has_hits': 712,
             'precision': 0.03568165424380844,
             'precision_on_has_hits': 0.20842696629213384,
             'recall': 0.015966187822203555}},
 {'key': 'rec_query_tracks_with_user_scaled@5',
  'values': {'avg_hits': 0.19908631882664102,
             'avg_hits_on_has_hits': 1.6108949416342413,
             'has_hits': 514,
             'precision': 0.03981726376532819,
             'precision_on_has_hits': 0.3221789883268481,
             'recall': 0.009317309724788943}},
 {'key': 'rec_first_two_query_tracks_with_user@1',
  'values': {'avg_hits': 0.041115652801154125,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 171,
             'precision': 0.041115652801154125,
             'precision_on_has_hits': 1.0,
             'recall': 0.0017439541196745652}},
 {'key': 'rec_query_tracks_with_user_scaled@1',
  'values': {'avg_hits': 0.04568405866794903,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 190,
             'precision': 0.04568405866794903,
             'precision_on_has_hits': 1.0,
             'recall': 0.0022475590695758313}},
 {'key': 'rec_first_two_query_tracks_with_user_scaled@15',
  'values': {'avg_hits': 0.7071411396970425,
             'avg_hits_on_has_hits': 2.705611775528979,
             'has_hits': 1087,
             'precision': 0.04714274264646931,
             'precision_on_has_hits': 0.18037411836859785,
             'recall': 0.035169310168912025}},
 {'key': 'rec_first_two_query_tracks_with_user_scaled@10',
  'values': {'avg_hits': 0.5140658812214475,
             'avg_hits_on_has_hits': 2.2890792291220556,
             'has_hits': 934,
             'precision': 0.05140658812214435,
             'precision_on_has_hits': 0.22890792291220383,
             'recall': 0.026494115173977765}},
 {'key': 'rec_first_two_query_tracks_with_user_scaled@5',
  'values': {'avg_hits': 0.2916566482327483,
             'avg_hits_on_has_hits': 1.7108603667136812,
             'has_hits': 709,
             'precision': 0.058331329646549364,
             'precision_on_has_hits': 0.3421720733427346,
             'recall': 0.015438243529649768}},
 {'key': 'rec_first_two_query_tracks@15',
  'values': {'avg_hits': 0.949747535465256,
             'avg_hits_on_has_hits': 3.4347826086956523,
             'has_hits': 1150,
             'precision': 0.06331650236435006,
             'precision_on_has_hits': 0.22898550724637556,
             'recall': 0.05790366421443664}},
 {'key': 'rec_query_tracks@15',
  'values': {'avg_hits': 1.0598701610964174,
             'avg_hits_on_has_hits': 4.166351606805293,
             'has_hits': 1058,
             'precision': 0.07065801073976086,
             'precision_on_has_hits': 0.27775677378701835,
             'recall': 0.06760577607701482}},
 {'key': 'rec_first_two_query_tracks_with_user_scaled@1',
  'values': {'avg_hits': 0.07117095455638374,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 296,
             'precision': 0.07117095455638374,
             'precision_on_has_hits': 1.0,
             'recall': 0.003676203047004247}},
 {'key': 'rec_first_two_query_tracks@10',
  'values': {'avg_hits': 0.7165183938446742,
             'avg_hits_on_has_hits': 2.91015625,
             'has_hits': 1024,
             'precision': 0.0716518393844674,
             'precision_on_has_hits': 0.2910156249999999,
             'recall': 0.044613737209861164}},
 {'key': 'rec_query_tracks@10',
  'values': {'avg_hits': 0.8239961529213753,
             'avg_hits_on_has_hits': 3.489816700610998,
             'has_hits': 982,
             'precision': 0.08239961529213759,
             'precision_on_has_hits': 0.34898167006110004,
             'recall': 0.05485844826378006}},
 {'key': 'rec_first_two_query_tracks_mean@15',
  'values': {'avg_hits': 1.2616013464775186,
             'avg_hits_on_has_hits': 4.461734693877551,
             'has_hits': 1176,
             'precision': 0.08410675643183406,
             'precision_on_has_hits': 0.2974489795918349,
             'recall': 0.08041923526374221}},
 {'key': 'rec_first_two_query_tracks@5',
  'values': {'avg_hits': 0.42101466698725654,
             'avg_hits_on_has_hits': 2.0894988066825775,
             'has_hits': 838,
             'precision': 0.08420293339745073,
             'precision_on_has_hits': 0.41789976133651263,
             'recall': 0.027186483529088742}},
 {'key': 'rec_first_two_query_tracks_mean@10',
  'values': {'avg_hits': 0.9646549651358499,
             'avg_hits_on_has_hits': 3.714814814814815,
             'has_hits': 1080,
             'precision': 0.09646549651358531,
             'precision_on_has_hits': 0.3714814814814827,
             'recall': 0.0639640355164027}},
 {'key': 'rec_query_tracks@5',
  'values': {'avg_hits': 0.49026208223130563,
             'avg_hits_on_has_hits': 2.4187425860023724,
             'has_hits': 843,
             'precision': 0.09805241644626053,
             'precision_on_has_hits': 0.48374851720047163,
             'recall': 0.03389541714857926}},
 {'key': 'rec_first_two_query_tracks@1',
  'values': {'avg_hits': 0.10387112286607357,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 432,
             'precision': 0.10387112286607357,
             'precision_on_has_hits': 1.0,
             'recall': 0.0067973882030584395}},
 {'key': 'rec_first_two_query_tracks_mean@5',
  'values': {'avg_hits': 0.5597499398893965,
             'avg_hits_on_has_hits': 2.5222101841820153,
             'has_hits': 923,
             'precision': 0.11194998797787865,
             'precision_on_has_hits': 0.5044420368364001,
             'recall': 0.03880294447945316}},
 {'key': 'rec_query_tracks@1',
  'values': {'avg_hits': 0.1170954556383746,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 487,
             'precision': 0.1170954556383746,
             'precision_on_has_hits': 1.0,
             'recall': 0.008068601248256136}},
 {'key': 'rec_first_two_query_tracks_mean@1',
  'values': {'avg_hits': 0.1288771339264246,
             'avg_hits_on_has_hits': 1.0,
             'has_hits': 536,
             'precision': 0.1288771339264246,
             'precision_on_has_hits': 1.0,
             'recall': 0.008788623551781}}]
2017-11-11 02:21:55,592 - __main__ - INFO - %%% evaluation done in 20047.025s


------------- done -------------
2017-11-11 02:21:55,939 - __main__ - INFO - %%% playlist_eval runner done in 32288.475s


